--delete from fichier;


alter table FICHIER add contenu BLOB;


insert into FICHIER(
  ID,
  NOM,
  TYPE_MIME,
  TAILLE,
  DESCRIPTION,
  THESE_ID,
  VERSION_FICHIER_ID,
  HISTO_CREATION,
  HISTO_CREATEUR_ID,
  HISTO_MODIFICATION,
  HISTO_MODIFICATEUR_ID,
  HISTO_DESTRUCTION,
  HISTO_DESTRUCTEUR_ID,
  EST_ANNEXE,
  NOM_ORIGINAL,
  EST_CONVERTI,
  EST_EXPURGE,
  EST_CONFORME,
  RETRAITEMENT,
  NATURE_ID,
  CONTENU
)
  select
    ID,
    NOM,
    TYPE_MIME,
    TAILLE,
    DESCRIPTION,
    THESE_ID,
    VERSION_FICHIER_ID,
    HISTO_CREATION,
    HISTO_CREATEUR_ID,
    HISTO_MODIFICATION,
    HISTO_MODIFICATEUR_ID,
    HISTO_DESTRUCTION,
    HISTO_DESTRUCTEUR_ID,
    EST_ANNEXE,
    NOM_ORIGINAL,
    EST_CONVERTI,
    EST_EXPURGE,
    EST_CONFORME,
    RETRAITEMENT,
    NATURE_ID,
    CONTENU
  from sodoct.FICHIER@DOCTPROD
;


insert into CONTENU_FICHIER(ID, FICHIER_ID, DATA)
  select CONTENU_FICHIER_ID_SEQ.nextval, f.id, f.CONTENU
  from FICHIER f
;


alter table FICHIER drop column CONTENU;
