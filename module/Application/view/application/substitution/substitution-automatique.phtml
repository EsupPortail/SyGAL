<?php

use Application\Entity\Db\EcoleDoctorale;
use Application\Entity\Db\Etablissement;
use Application\Entity\Db\StructureConcreteInterface;

/**
 * @var [EcoleDoctorale, EcoleDoctorale[]] $ecoles_substitutions
 * @var [Etablissement, Etablissement[]] $etablissements_substitutions
 */

echo '<div>';
displaySubstitutions($ecoles_substitutions, $type = "EcoleDoctorale");
echo '</div>';
echo '<div>';
displaySubstitutions($unites_substitutions, $type = "UniteRecherche");
echo '</div>';
echo '<div>';
displaySubstitutions($etablissements_substitutions, $type = "Etablissement");
echo '</div>';

function displaySubstitutions($substitutions, $type = "structures") {

    echo '<h3>'.count($substitutions) . ' substitutions de ' . $type . '</h3>';
    foreach ($substitutions as $substitution) {

        /** @var StructureConcreteInterface $substituante */
        $substituante = $substitution[1];
        /** @var StructureConcreteInterface[] $substituees */
        $substituees = $substitution[0];

        echo '<table class="table table-extra-condensed">';
        echo '<tr> <th> Substitu√©es (' . count($substituees) . ') </th><th> Substituante </th></tr>';
        for ($position = 0; $position < count($substituees); $position++) {
            echo '<tr>';
            echo '<td>';
            echo $substituees[$position]->getSourceCode() . "<br/>";
            echo $substituees[$position]->getSigle() . "<br/>";
            echo $substituees[$position]->getLibelle();
            echo '</td>';
            echo '<td>';
            if ($position === 0) {
                echo $substituante->getSourceCode() . "<br/>";
                echo $substituante->getSigle() . "<br/>";
                echo $substituante->getLibelle();
            }
            echo '</td>';
            echo '</tr>';
        }
        echo '</table>';
    }
}